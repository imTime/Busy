#[Solo]imTime跨平台项目经验分享—技术选型

##历史

2011年中我发布了imTime的第一版，准确来说应该是1.5版，因为中间又经历过一些的改动。最初是用Asp.Net写的，也没什么原因，因为我自己对.Net熟悉。正好我自己写了一个三层的框架，系统采用C#开发，三层架构，模板采用XSLT，数据与实现分离。

##问题

首当其冲的是Windows平台的局限性，做网站的都知道，Windows平台的VPS不仅会贵上1/3，而且最要命的是，同样配置的Windows服务器要比Linux服务器差很多。可维护也要差很多，许多VPS或者云平台根本不提供Windows的服务器，比如说Linode。当然有些人说可以使用Mono，我没有使用过Mono，但这种非官方的解决方案使用起来，总是有点忐忑。

##Node.JS还是PHP

在Node.js没有出现在我的视线里之前，我有考虑过PHP，但那段时间里正好忙别的事，并且我的PHP也很菜，所以事情就不了了之了。

当我第一次知道Node.js这个项目之后，简直是太让人兴奋了，如果服务器能直接用Javascript实现高性能的服务器，那还有什么地方不能用Javascript呢。

选择Node.js是有考量的，第一当然是服务器和客户端都能用同一种语言开发甚至共用代码。这对于个人或者小团队开发来说是很重要的，通常一个程序员熟悉的语言就那么一两种，高级点的程序员会熟悉多种语言。

跨平台也很重要，我需要在iOS/Android/WP和PC上运行Busy，还要包括第三方平台。试想一下，如果要让你把产品运行在超过30个平台上，如果没有一种跨平台解决方案，就算你的服务器提供REST API和OAuth，你要请多少人花多少时间才能搞定？

Node.JS的高并发能力也很重要，根据我的规划，Busy只是把数据同步服务器，用户的80%的操作将与服务器无关。我开发大量的客户端，目的就是要让用户减少对服务器资源的战用。这个和产品的属性有关，我的目的是服务尽可能多的用户，而不是提高访问量，所以占用带宽对我来说没有一点好处。

###MongoDB还是MySql

既然选择Node.JS，那么数据库主要也就是两种选择——MongoDB和MySql。对于我来说，我当然倾向于选择MongoDB，毕竟是一个实验性的项目，我也没打算让imTime盈利，甚至我愿意每年花一万块钱来维持imTime的正常运行。

MongoDB与Node.JS天生就是一对，速度快肯定是我选择的重要原因之一，还有MongoDB可以直接输出JSON数据，对于REST API来说非常友好。当然还有一个原因是MongoDB是一种新技术，我想研究研究。

##思考

从技术的角度上来看，我这种折腾是很有必要的，做技术的不折腾怎么能提高？但从产品的角度，这种彻底的重构是要慎重考虑的。通常我们采取的原则是部分重构，新旧并行，逐步替代的解决方案。

所以说自己的非盈利性项目就是这种好，我喜欢玩什么语言就用什么语言，我喜欢产品长什么样就长什么样。对于这种彻底推倒重来一定要慎之又慎，新的东西不仅Bug众多，而且未必会比旧的好。

对于新技术，小范围内应用研究，逐步推广是可取之法，新技术可能会有你不能把控的问题。像我这种激进全面替代是不可取的，因为我这个是个人项目，所以做起来比较随意。
